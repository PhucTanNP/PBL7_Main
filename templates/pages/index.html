{% extends "layouts/base.html" %}

{% block title %}Home{% endblock title %}

{% block content %}
<div class="pc-container">
  <div class="pc-content">
    <!-- [ breadcrumb ] start -->
    

    <form method="GET" action="{{ url_for('home_blueprint.index') }}" class="row g-3 align-items-end mb-4">

    <div class="collapse mb-4" id="searchFormWrapper">
      <div class="row">
      <!-- Kinh nghi·ªám -->
      <div class="col-md-3">
        <label for="experience" class="form-label">S·ªë nƒÉm kinh nghi·ªám</label>
        <select class="form-select" name="experience">
          <option value="">T·∫•t c·∫£</option>
          {% for i in range(1, 11) %}
            <option value="{{ i }}" {% if request.args.get('experience') == i|string %}selected{% endif %}>{{ i }} nƒÉm</option>
          {% endfor %}
        </select>
      </div>
    
      <!-- V·ªã tr√≠ tuy·ªÉn d·ª•ng -->
      <div class="col-md-3">
        <label for="position" class="form-label">V·ªã tr√≠ tuy·ªÉn d·ª•ng</label>
        <select class="form-select" name="position">
          <option value="">T·∫•t c·∫£ v·ªã tr√≠</option>
          {% for option in [
            '.Net', 'Ai', 'Android', 'Angular', 'Automation Test', 'AWS', 'Ba', 'Backend',
            'Big Data', 'Bigdata', 'Blockchain', 'C', 'C#', 'C++', 'C++ Dev', 'C++/C',
            'C/C++', 'Ci/Cd', 'Ci/Cd Dev', 'Cicd Developer', 'Cloud (Aws)', 'Cloud Engineer',
            'Cobol', 'Cocos Engineer', 'Cocos Game', 'Comtor', 'Cto', 'Data Analyst',
            'Data Consultant', 'Data Engineer', 'Data Science', 'Data Scientist',
            'Data Warehouse', 'Database', 'Database Dev', 'Database Engineer',
            'Database Specialists', 'Dba', 'Dba And Database Developer', 'Delivery Manager',
            'Devops', 'Drupal', 'Embedded', 'Flutter', 'Fpga', 'Fronend', 'Front End'
            , 'Game Designer', 'Game Dev', 'Game Tester', 'Golang', 'Html',
            'Html/Css/Javascript', 'Html5', 'Infra Engineer', 'Ios', 'Iot', 'It Help Desk',
            'Java', 'Javascript', 'Junior', 'Kotlin', 'Machine Learning', 'Magento',
            'Manual Test', 'Mi', 'Mobile', 'Node Js', 'Nodejs', 'Outsystem', 'Pattern Engineer',
            'Php', 'Pm', 'Pm/Po', 'Pm/Po/Sm', 'Pm/Tl', 'Po', 'Pqa', 'Pqa Leader',
            'Product Manager', 'Product Owner', 'Project Manager', 'Python', 'Python Dev',
            'Qa', 'Qc', 'React Js', 'React Native', 'Reactjs', 'Rpa', 'Rtc', 'Ruby',
            'Ruby On Rails', 'Sa', 'Salesforce', 'Salesforce Developer', 'Scrum Assistant',
            'Scrum Master', 'Security Engineer', 'Senior Software Engineer', 'Server',
            'Sharepoint', 'Sharepoint Developer', 'Sm', 'Software Architect',
            'Software Technical Writer', 'Solution Architect', 'System Engineer', 'Ta',
            'Team Lead', 'Technical Architect', 'Technical Leader', 'Tester', 'Thi·∫øt K·∫ø Ui/Ux',
            'Tl', 'Unity', 'Urgent', 'Vuejs', 'Web Rtc', 'Windows Phone', 'Wordpress',
            'Xamarin'
          ] %}
            <option value="{{ option }}" {% if request.args.get('position') == option %}selected{% endif %}>
              {{ option }}
            </option>
          {% endfor %}
        </select>
      </div>

    
      <!-- Ph∆∞∆°ng th·ª©c ·ª©ng tuy·ªÉn -->
      <div class="col-md-2">
        <label for="job_type" class="form-label">Ph∆∞∆°ng th·ª©c</label>
        <select class="form-select" name="job_type">
          <option value="">T·∫•t c·∫£</option>
          <option value="online" {% if request.args.get('job_type') == 'online' %}selected{% endif %}>Apply Online</option>
          <option value="offline" {% if request.args.get('job_type') == 'offline' %}selected{% endif %}>Apply Offline</option>
        </select>
      </div>
    
      <!-- ƒê·ªãa ƒëi·ªÉm -->
      <div class="col-md-2">
        <label for="location" class="form-label">ƒê·ªãa ƒëi·ªÉm</label>
        <select class="form-select" name="location">
          <option value="">T·∫•t c·∫£</option>
          {% for province in [
            'An Giang', 'B√† R·ªãa - V≈©ng T√†u', 'B·∫Øc Giang', 'B·∫Øc K·∫°n', 'B·∫°c Li√™u', 'B·∫Øc Ninh',
            'B·∫øn Tre', 'B√¨nh ƒê·ªãnh', 'B√¨nh D∆∞∆°ng', 'B√¨nh Ph∆∞·ªõc', 'B√¨nh Thu·∫≠n', 'C√† Mau',
            'C·∫ßn Th∆°', 'Cao B·∫±ng', 'ƒê√† N·∫µng', 'ƒê·∫Øk L·∫Øk', 'ƒê·∫Øk N√¥ng', 'ƒêi·ªán Bi√™n', 'ƒê·ªìng Nai',
            'ƒê·ªìng Th√°p', 'Gia Lai', 'H√† Giang', 'H√† Nam', 'H√† N·ªôi', 'H√† Tƒ©nh', 'H·∫£i D∆∞∆°ng',
            'H·∫£i Ph√≤ng', 'H·∫≠u Giang', 'H√≤a B√¨nh', 'H∆∞ng Y√™n', 'Kh√°nh H√≤a', 'Ki√™n Giang',
            'Kon Tum', 'Lai Ch√¢u', 'L√¢m ƒê·ªìng', 'L·∫°ng S∆°n', 'L√†o Cai', 'Long An', 'Nam ƒê·ªãnh',
            'Ngh·ªá An', 'Ninh B√¨nh', 'Ninh Thu·∫≠n', 'Ph√∫ Th·ªç', 'Ph√∫ Y√™n', 'Qu·∫£ng B√¨nh',
            'Qu·∫£ng Nam', 'Qu·∫£ng Ng√£i', 'Qu·∫£ng Ninh', 'Qu·∫£ng Tr·ªã', 'S√≥c TrƒÉng', 'S∆°n La',
            'T√¢y Ninh', 'Th√°i B√¨nh', 'Th√°i Nguy√™n', 'Thanh H√≥a', 'Th·ª´a Thi√™n Hu·∫ø', 'Ti·ªÅn Giang',
            'H·ªì Ch√≠ Minh', 'Tr√† Vinh', 'Tuy√™n Quang', 'Vƒ©nh Long', 'Vƒ©nh Ph√∫c', 'Y√™n B√°i'
          ] %}
            <option value="{{ province }}" {% if request.args.get('location') == province %}selected{% endif %}>{{ province }}</option>
          {% endfor %}
        </select>
      </div>
    
      <!-- N√∫t t√¨m -->
      <div class="col-md-1 d-flex align-items-end">
        <button type="submit" class="btn btn-outline-primary w-100">T√¨m</button>
      </div>
      
      {% if current_user.role == 'HR' %}
        <div class="col-md-1 d-flex align-items-end">
          <button type="button" class="btn btn-success fw-bold w-100" data-bs-toggle="modal" data-bs-target="#postJobModal">
            + ƒêƒÉng
          </button>
        </div>
      {% endif %}
    </div>
  </div>

    
    </form>
      <!-- [ Main Content ] start -->
      <div class="row g-3 pb-4">
        {% for job in jobs %}
        <div class="col-md-6 col-xl-4">
          <div class="card card-social shadow-sm border-0 h-100 d-flex flex-column"
              style="border-radius: 0.5rem; overflow: hidden;"
              data-bs-toggle="modal"
              data-bs-target="#jobModal{{ job.id_job }}"
              title="Nh·∫•p ƒë·ªÉ xem chi ti·∫øt">


                <div class="card-body border-bottom bg-light rounded-top">
                  <div class="row align-items-center justify-content-between">
                    <div class="col-auto">
                      <i class="fas fa-briefcase text-primary f-36"></i>
                    </div>
                    <div class="col text-end">
                      <h5 class="mb-0 fw-semibold text-dark">{{ job.job_title }}</h5>
                      <small class="text-muted fst-italic">{{ job.company_name }}</small>
                    </div>
                  </div>
                </div>

                <div class="card-body bg-white rounded-bottom">
                <div class="row text-center border-top pt-3">
                  <div class="col-6 border-end">
                    <div class="text-muted small">üí∞ L∆∞∆°ng</div>
                    <div class="fw-semibold text-dark">{{ job.salary or 'Th·ªèa thu·∫≠n' }}</div>
                  </div>
                  <div class="col-6">
                    <div class="text-muted small">üìÖ H·∫°n n·ªôp</div>
                    <div class="fw-semibold text-dark">{{ job.deadline }}</div>
                  </div>
                  <div class="col-12 mt-2">
                    <div class="text-muted small">üè∑Ô∏è Ng√†nh ngh·ªÅ</div>
                    <div class="fw-semibold text-dark">{{ job.industry or 'Kh√¥ng x√°c ƒë·ªãnh' }}</div>
                  </div>
                  
                </div>
                <div class="text-center mt-3">
                  <span class="badge rounded-pill px-3 py-2 fw-semibold text-white 
                    {% if job.job_type == 'online' %}
                      bg-success
                    {% else %}
                      bg-secondary
                    {% endif %}">
                    <i class="fas fa-laptop me-1"></i> Apply {{ job.job_type|capitalize }}
                  </span>
                </div>
            </div>
        </div>

            <!-- Modal -->
            
        <div class="modal fade" id="jobModal{{ job.id_job }}" tabindex="-1" aria-labelledby="jobModalLabel{{ job.id_job }}" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="jobModalLabel{{ job.id_job }}">{{ job.job_title }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
            <div class="modal-body">
                <!-- B·∫£ng th√¥ng tin c√¥ng vi·ªác -->
                <table class="table table-bordered table-striped">
                    <tbody>
                        <tr>
                            <th>Ph∆∞∆°ng th·ª©c ·ª©ng tuy·ªÉn</th>
                            <td>{{ job.job_type|upper }}</td>

                        </tr>
                        <tr>
                            <th>C√¥ng ty</th>
                            <td>{{ job.company_name }}</td>
                        </tr>
                        <tr>
                            <th>N∆°i l√†m vi·ªác</th>
                            <td>{{ job.location }}</td>
                        </tr>
                        <tr>
                            <th>L∆∞∆°ng</th>
                            <td>{{ job.salary or 'Th·ªèa thu·∫≠n' }}</td>
                        </tr>
                        <tr>
                          <th>M√¥ t·∫£</th>
                          <td>{{ job.job_title }}</td>  <!-- ho·∫∑c job.description n·∫øu b·∫°n c√≥ d√πng l·∫°i -->
                        </tr>
                        <tr>
                            <th>Kinh nghi·ªám y√™u c·∫ßu</th>
                            <td>{{ job.experience or 'Kh√¥ng y√™u c·∫ßu' }} NƒÉm </td>
                        </tr>
                      
                        <tr>
                            <th>H·∫°n n·ªôp</th>
                            <td>{{ job.deadline }}</td>
                        </tr>
                        <tr>
                          <th>Ng√†nh ngh·ªÅ</th>
                          <td>{{ job.industry or 'Kh√¥ng x√°c ƒë·ªãnh' }}</td>
                        </tr>
                        
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
              {% if job.job_type == 'online' %}
              <form method="POST" action="{{ url_for('jobs_blueprint.apply_job', job_id=job.id_job) }}">
                  <button type="submit" class="btn btn-primary" onclick="alert('·ª®ng tuy·ªÉn th√†nh c√¥ng!')">
                      G·ª≠i CV c·ªßa b·∫°n
                  </button>
              </form>
              {% endif %}
              
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
            </div>
        </div>
            </div>
        </div>
        </div>
        {% endfor %}
      </div>

      <!-- Pagination -->
      {% if not (request.args.experience or request.args.position or request.args.job_type or request.args.location) %}
      <div class="d-flex justify-content-center mt-4">
          {% if page > 1 %}
              <a href="{{ url_for('home_blueprint.index',
                                  page=page - 1,
                                  experience=request.args.get('experience'),
                                  position=request.args.get('position'),
                                  job_type=request.args.get('job_type'),
                                  location=request.args.get('location')) }}"
                 class="btn btn-outline-primary mx-1">
                  Trang tr∆∞·ªõc
              </a>
          {% endif %}
      
          {% for p in range(page - 2, page + 3) if p > 0 and p <= total_pages %}
              <a href="{{ url_for('home_blueprint.index',
                                  page=p,
                                  experience=request.args.get('experience'),
                                  position=request.args.get('position'),
                                  job_type=request.args.get('job_type'),
                                  location=request.args.get('location')) }}"
                 class="btn {% if p == page %}btn-primary{% else %}btn-outline-primary{% endif %} mx-1">
                  {{ p }}
              </a>
          {% endfor %}
      
          {% if page < total_pages %}
              <a href="{{ url_for('home_blueprint.index',
                                  page=page + 1,
                                  experience=request.args.get('experience'),
                                  position=request.args.get('position'),
                                  job_type=request.args.get('job_type'),
                                  location=request.args.get('location')) }}"
                 class="btn btn-outline-primary mx-1">
                  Trang sau
              </a>
          {% endif %}
      </div>
      {% endif %}
      
    </div>
    <div class="modal fade" id="postJobModal" tabindex="-1" aria-labelledby="postJobModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <form method="POST" action="{{ url_for('jobs_blueprint.post_job') }}">


            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="postJobModalLabel">ƒêƒÉng b√†i tuy·ªÉn d·ª•ng m·ªõi</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
              </div>
              <div class="modal-body">
                <div class="row g-3">
                  <div class="col-md-6">
                    <label class="form-label">Ti√™u ƒë·ªÅ c√¥ng vi·ªác</label>
                    <input name="job_title" required class="form-control">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">T√™n c√¥ng ty</label>
                    <input name="company_name" required class="form-control">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">N∆°i L√†m Vi·ªác</label>
                    <input name="location" required class="form-control">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">L∆∞∆°ng</label>
                    <input name="salary" class="form-control">
                  </div>
                  <div class="col-md-12">
                    <label class="form-label">M√¥ t·∫£</label>
                    <textarea name="description" rows="3" class="form-control"></textarea>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">H·∫°n n·ªôp</label>
                    <input type="date" name="deadline" required class="form-control">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Kinh nghi·ªám y√™u c·∫ßu</label>
                    <input name="experience" class="form-control">
                  </div>
                  <div class="col-md-6">
                    <label class="form-label">Ng√†nh ngh·ªÅ</label>
                    <input name="industry" class="form-control" placeholder="V√≠ d·ª•: IT, Sales, Marketing">
                  </div>                  
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-primary" type="submit">ƒêƒÉng b√†i</button>
                <button class="btn btn-secondary" type="button" data-bs-dismiss="modal">H·ªßy</button>
              </div>
            </div>
          </form>
        </div>
      </div>
      
    
  </div>


  
{% endblock content %}

{% block extra_js %}
<script src="{{ url_for('static', filename='assets/js/plugins/apexcharts.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/plugins/jsvectormap.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/plugins/world.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/pages/dashboard-default.js') }}"></script>
{% endblock extra_js %}
